'use strict';

var _getType = require('./getType');

var _getType2 = _interopRequireDefault(_getType);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

var ObjectType = 'object';

/**
 * 深拷贝
 * @param  {...Object}  object
 * @return {Object}
 */
// == utils ==
module.exports = function deepMerge() {
  for (var _len = arguments.length, objects = Array(_len), _key = 0; _key < _len; _key++) {
    objects[_key] = arguments[_key];
  }

  return objects.reduce(function (prev, curr) {
    return _deepMerge(prev, curr);
  });
};

function _deepMerge(object, anotherOject) {
  if ((0, _getType2.default)(object) !== ObjectType || (0, _getType2.default)(anotherOject) !== ObjectType) return object;

  for (var name in anotherOject) {
    if (!anotherOject.hasOwnProperty(name)) continue;
    var subObject = object[name];
    var anotherSubObject = anotherOject[name];

    var subObjectType = (0, _getType2.default)(subObject);
    var anotherSubObjectType = (0, _getType2.default)(anotherSubObject);

    if (anotherSubObjectType === ObjectType) anotherSubObject = Object.assign({}, anotherSubObject);

    if (!object.hasOwnProperty(name) || subObjectType !== ObjectType || anotherSubObjectType !== ObjectType) {
      object[name] = anotherSubObject;
      continue;
    }
    _deepMerge(subObject, anotherSubObject);
  }
  return object;
}