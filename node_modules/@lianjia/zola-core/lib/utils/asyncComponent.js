import React from 'react'

const NullComponent = null
module.exports = function asyncComponent (asyncModule, name = 'default') {
  return class AsyncComponent extends React.Component {
    constructor (props) {
      super(props)
      this.state = { Component: NullComponent }
    }
    componentWillMount () {
      if (this.state.Component !== NullComponent) return
      asyncModule.then(module => this.setState({ Component: module[name] }))
    }
    render () {
      if (this.state.Component === NullComponent) return null
      return React.createElement(this.state.Component, this.props)
    }
  }
}
