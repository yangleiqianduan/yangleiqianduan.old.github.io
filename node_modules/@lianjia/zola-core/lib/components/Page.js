const propTypes = require('prop-types')
const inherit = require('../utils/inherit')
const Subscribe = require('../utils/subscribe')
const Base = require('./Base')

const Page = inherit('Page', Base, {
  getChildContext () {
    if (!this.subscribe) this.subscribe = new Subscribe()
    return {
      subscribe: this.subscribe,
      location: this.props.location
    }
  },
  componentWillUnmount () {
    Base.prototype.componentWillUnmount.call(this)
    if (this.subscribe) this.subscribe.off()
  }
})
Page.childContextTypes = {
  subscribe: propTypes.object,
  location: propTypes.object
}
module.exports = Page